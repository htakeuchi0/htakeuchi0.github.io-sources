---
title: "プラレール問題"
weight: 3
# bookFlatSection: false
# bookToc: true
# bookHidden: false
# bookCollapseSection: false
# bookComments: false
# bookSearchExclude: false
---

# プラレール問題

## 概要

前ページまでで，レールとレイアウトの形式的定義について述べました．
さて，レールとレイアウトに関するどのような問題が考えられるかについて述べます．

## プラレール問題

プラレールに関する問題について考えます．
通常，手元にあるレールは有限です．もう少し正確にいうと，有限種類のレールが有限個ずつあるのが普通です．レールは接続ができればどの向きにおいても裏返しても構わないのでした．

それをふまえて，まず準備として記号の定義を追加します．

{{< hint info >}}
{{< theorem-label name="Definition" >}} \\(\sigma\\) を \\(\\mathbb{R}^3\\) 上の直交変換とする．

1. \\(\phi\in\Phi\\) に対して \\(\phi^\sigma\\) を，\\(\phi^\sigma(\theta)=\phi(\theta)^\sigma\,(0<\theta<1)\\) で定める．
2. レール \\(r=(\phi_1,\dots,\phi_n,t_1,\dots,t_m,\psi,u_1,\dots,u_{n-1})\in\mathcal{R}\\) に対して \\(r^\sigma\\) を，\\(r^\sigma=(\phi^\sigma_1,\dots,\phi^\sigma_n,t_1,\dots,t_m,\psi,u_1^\sigma,\dots,u_{n-1}^\sigma)\\) で定める．
{{< katex >}}{{< /katex >}}
{{< /hint >}}

{{< katex >}}\sigma{{< /katex >}} は3次元空間上の回転を表すので，これでレールの回転を表すことができるようになりました．

{{< hint info >}}
{{< theorem-label name="Definition" >}} \\(N\\) を1以上の整数とし，\\(r_1,\dots,r_N\\) をレール，\\(n_1,\dots,n_N\\) を1以上の整数とする．レイアウト \\(R=(r\'_1,\dots,r\'_n,c_1,\dots,c_m)\\) について，各 \\(i=1,2,\dots,n\\) について，\\(j_i\\) と，ある \\(\mathbb{R}^3\\) 上の直交変換 \\(\sigma_i\\) が存在し，\\(r\'\_i=r\_{j_i}^{\sigma_i}\\) であり，\\(|\\{j\mid \exists \sigma\\,(r_i={r\'_j}^\sigma\\}|\le n_i\\) であるとき，レイアウト \\(R\\) は \\(r\'_1,\dots,r\'_n,c_1,\dots,c_m\\) で **実現可能** であるといい，このレイアウト全体を \\(\\mathcal{A}\_{r\_1,\dots,r_N,n_1,\dots,n_N}\\) で表す．

{{< /hint >}}

実現可能という定義は，手元のレールセットでレイアウトが組めるものを指します．

このとき，以下の問題が考えられます．

{{< hint info >}}
{{< theorem-label name="Problem" >}} \\(N\\) を1以上の整数とし，\\(r_1,\dots,r_N\\) をレール，\\(n_1,\dots,n_N\\) を1以上の整数とする．

1. \\(R\in\\mathcal{A}\_{r\_1,\dots,r_N,n_1,\dots,n_N}\\) であり，\\(R\\) が完全レイアウトであるものを一つ求めよ．
2. \\(R\in\\mathcal{A}\_{r\_1,\dots,r_N,n_1,\dots,n_N}\\) であり，\\(R\\) が完全レイアウトであるのうち，\\(R=(r_1,\dots,r_n,c_1,\dots,c_m)\\) における \\(n\\) が最大になるレイアウト \\(R\\) を一つ求めよ．
3. \\(\epsilon>0\\), \\(\epsilon'>0\\) とする．\\(R\in\\mathcal{A}\_{r\_1,\dots,r_N,n_1,\dots,n_N}\\) として，\\(R\\) が \\((\delta,\delta\')\\)-レイアウトのとき，すべての \\(i\\) について \\(\delta_i<\epsilon\\), すべての \\(i\\) について \\(\delta\'_i<\epsilon\'\\) であるものを1つ求めよ．
3. \\(\epsilon>0\\), \\(\epsilon'>0\\) とする．\\(R\in\\mathcal{A}\_{r\_1,\dots,r_N,n_1,\dots,n_N}\\) として，\\(R\\) が \\((\delta,\delta\')\\)-レイアウトのとき，すべての \\(i\\) について \\(\delta_i<\epsilon\\), すべての \\(i\\) について \\(\delta\'_i<\epsilon\'\\) であるもののうち，\\(R=(r_1,\dots,r_n,c_1,\dots,c_m)\\) における \\(n\\) が最大となるレイアウトを一つ求めよ．
{{< /hint >}}

Prob. 3. について，1, 2 はプラレールで環状のレイアウトを作る問題で，1に対して2はより大きい（多くのレールを使う）レイアウトを求める問題です．3, 4 はそれにいわゆる **なじませつなぎ** を許容して，環状のレイアウトを求める問題です．

一般には，車止めや車両基地など，環状とは限りませんが，ここでは簡単のため省略します．この場合，車止めなどの接続先が1方向しかない頂点にループをもたせることで回避可能と思われます．

## まとめ

レールやレイアウトは数学的モデル化が複雑であり，たとえばこの整理結果から，手元のレールセットで実現可能なレイアウトで，環状になるものを求めるのは難しいと思われます．

逆に，おもちゃとして成り立っているのは，レールは規格で決まっているため，レイアウトはヒューリスティックに組み上げることができて，そのためと思われます．


